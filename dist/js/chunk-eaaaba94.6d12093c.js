(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eaaaba94"],{"0a49":function(t,e,n){var r=n("9b43"),a=n("626a"),o=n("4bf8"),i=n("9def"),s=n("cd1c");t.exports=function(t,e){var n=1==t,c=2==t,l=3==t,u=4==t,f=6==t,p=5==t||f,d=e||s;return function(e,s,m){for(var h,g,y=o(e),k=a(y),v=r(s,m,3),_=i(k.length),b=0,w=n?d(e,_):c?d(e,0):void 0;_>b;b++)if((p||b in k)&&(h=k[b],g=v(h,b,y),t))if(n)w[b]=g;else if(g)switch(t){case 3:return!0;case 5:return h;case 6:return b;case 2:w.push(h)}else if(u)return!1;return f?-1:l||u?u:w}}},7514:function(t,e,n){"use strict";var r=n("5ca1"),a=n("0a49")(5),o="find",i=!0;o in[]&&Array(1)[o](function(){i=!1}),r(r.P+r.F*i,"Array",{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")(o)},"96bf":function(t,e,n){"use strict";var r=n("c518"),a=n.n(r);a.a},b56e:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Row",[n("Card",[n("p",{attrs:{slot:"title"},slot:"title"},[n("Icon",{attrs:{type:"md-person"}}),t._v("\n        我的工单\n      ")],1),n("Form",{ref:"queryForm",attrs:{inline:""}},[n("FormItem",[n("Input",{attrs:{placeholder:"工单说明"},on:{"on-keyup":function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.queryData(e)}},model:{value:t.find.text,callback:function(e){t.$set(t.find,"text",e)},expression:"find.text"}})],1),n("FormItem",[n("DatePicker",{staticStyle:{width:"250px"},attrs:{format:"yyyy-MM-dd HH:mm",type:"datetimerange",placeholder:"请选择查询的时间范围",editable:!1},on:{"on-change":function(e){t.find.picker=e}},model:{value:t.find.picker,callback:function(e){t.$set(t.find,"picker",e)},expression:"find.picker"}})],1),n("FormItem",[n("Button",{attrs:{type:"success"},on:{click:t.queryData}},[t._v("查询")])],1),n("FormItem",[n("Button",{attrs:{type:"primary"},on:{click:t.queryCancel}},[t._v("重置")])],1)],1),n("Row",[n("Col",{attrs:{span:"24"}},[n("Table",{attrs:{border:"",columns:t.columnsName,data:t.table_data,stripe:"",size:"small"},scopedSlots:t._u([{key:"action",fn:function(e){var r=e.row;return[n("div",[n("Button",{staticClass:"margin-left-10",attrs:{type:"success",size:"small",ghost:""},on:{click:function(e){return t.open_modal(r)}}},[t._v("\n                  工单信息\n                ")]),2!==r.Status?n("Button",{staticClass:"margin-left-10",attrs:{type:"warning",size:"small",ghost:""},on:{click:function(e){return t.openOrder(r)}}},[t._v("\n                  执行信息\n                ")]):t._e(),n("Poptip",{attrs:{confirm:"",title:"确定要撤销工单吗？",transfer:""},on:{"on-ok":function(e){return t.delOrder(r)}}},[2===r.Status?n("Button",{staticClass:"margin-left-10",attrs:{type:"primary",ghost:"",size:"small"}},[t._v("工单撤销")]):t._e()],1),0===r.Status?n("Button",{staticClass:"margin-left-10",attrs:{type:"error",size:"small",ghost:""},on:{click:function(e){return t.orderReject(r)}}},[t._v("驳回理由\n                ")]):t._e()],1)]}}])})],1)],1),n("br"),n("Page",{ref:"page",attrs:{total:t.page_number,"show-elevator":"","page-size":20},on:{"on-change":t.currentpage}})],1)],1),n("Modal",{attrs:{width:"1000"},model:{value:t.openModal,callback:function(e){t.openModal=e},expression:"openModal"}},[n("p",{staticStyle:{color:"#f60","font-size":"16px"},attrs:{slot:"header"},slot:"header"},[n("Icon",{attrs:{type:"information-circled"}}),n("span",[t._v("SQL工单详细信息")])],1),n("Form",{attrs:{"label-position":"right"}},[n("FormItem",{attrs:{label:"环境:"}},[n("span",[t._v(t._s(t.formitem.IDC))])]),n("FormItem",{attrs:{label:"连接名称:"}},[n("span",[t._v(t._s(t.formitem.Source))])]),n("FormItem",{attrs:{label:"数据库库名:"}},[n("span",[t._v(t._s(t.formitem.DataBase))])]),n("FormItem",{attrs:{label:"数据库表名:"}},[n("span",[t._v(t._s(t.formitem.Table))])]),n("FormItem",{attrs:{label:"定时执行:"}},[n("span",[t._v(t._s(t.formitem.Delay))])]),n("FormItem",{attrs:{label:"工单说明:"}},[n("span",[t._v(t._s(t.formitem.Text))])]),n("FormItem",[n("Table",{attrs:{columns:t.sql_columns,data:t.sql,"max-height":300}})],1)],1)],1)],1)},a=[],o=(n("ac6a"),n("7514"),n("bc3a")),i=n.n(o),s={name:"put",data:function(){return{openModal:!1,columnsName:[{title:"工单编号:",key:"WorkId",sortable:!0},{title:"工单说明",key:"Text",tooltip:!0},{title:"是否备份",key:"Backup"},{title:"提交时间:",key:"Date",sortable:!0},{title:"审核/执行人",key:"Assigned",sortable:!0},{title:"多级审核执行人",key:"Executor",sortable:!0},{title:"状态",key:"Status",render:function(t,e){var n=e.row,r="",a="";return 2===n.Status?(r="primary",a="待审核"):0===n.Status?(r="error",a="驳回"):1===n.Status?(r="success",a="已执行"):4===n.Status?(r="error",a="执行失败"):5===n.Status?(r="primary",a="待执行"):(r="warning",a="执行中"),t("Tag",{props:{type:"dot",color:r}},a)},sortable:!0},{title:"操作",key:"action",align:"center",slot:"action",width:250}],page_number:1,computer_room:this.$config.computer_room,table_data:[],find:{picker:[],valve:!1,text:""},multi:!1,formitem:{},sql:[],sql_columns:[{title:"sql",key:"SQL"}]}},methods:{open_modal:function(t){var e=this;i.a.get("".concat(this.$config.url,"/fetch/sql?k=").concat(t.WorkId)).then(function(t){e.sql=t.data}).catch(function(t){return e.$config.err_notice(e,t)}),this.openModal=!0,this.formitem=t},currentpage:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;i.a.put("".concat(this.$config.url,"/user/order"),{page:e,find:this.find}).then(function(e){if(!e.data.multi)for(var n=0;n<t.columnsName.length;n++)"Executor"===t.columnsName[n].key&&t.columnsName.splice(n,1);t.table_data=e.data.data,t.table_data.forEach(function(t){1===t.Backup?t.Backup="是":t.Backup="否"}),t.page_number=parseInt(e.data.page)}).catch(function(e){t.$config.err_notice(t,e)})},queryData:function(){this.find.valve=!0,this.currentpage()},queryCancel:function(){this.find=this.$config.clearPicker(this.find),this.$refs.page.currentPage=1,this.currentpage()},openOrder:function(t){this.$router.push({name:"orderlist",query:{workid:t.WorkId,status:t.Status}})},orderReject:function(t){this.$Modal.error({title:"驳回理由",content:t.Rejected})},delOrder:function(t){var e=this;i.a.get("".concat(this.$config.url,"/fetch/undo?work_id=").concat(t.WorkId)).then(function(t){e.$config.notice(t.data),e.currentpage(e.$refs.page.currentPage)}).catch(function(t){e.$config.err_notice(e,t)})}},mounted:function(){this.currentpage()}},c=s,l=(n("96bf"),n("2877")),u=Object(l["a"])(c,r,a,!1,null,null,null);e["default"]=u.exports},c518:function(t,e,n){},cd1c:function(t,e,n){var r=n("e853");t.exports=function(t,e){return new(r(t))(e)}},e853:function(t,e,n){var r=n("d3f4"),a=n("1169"),o=n("2b4c")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),r(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}}}]);
//# sourceMappingURL=chunk-eaaaba94.6d12093c.js.map